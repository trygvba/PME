\documentclass[11pt, a4paper]{article}
\usepackage{mathptmx}
\usepackage{mathtools}
\usepackage{amssymb}
%\usepackage{amsfonts}
%\usepackage{amsmath}
\usepackage{fullpage}
\usepackage{enumerate}
\usepackage{amsthm}
\usepackage{remreset}
\usepackage[utf8]{inputenc}
\usepackage[toc,page]{appendix}

\usepackage{lmodern}

\begin{document}
\title{Stuff that may well go into the project report}
\author{Trygve Bærland}
\maketitle
\abstract{For now, heavily reliant on \cite{vazquez2007porous}}

% My text categories:
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}{Proposition}[section]

\theoremstyle{definition}
\newtheorem{mydef}{Definition}[section]
\newtheorem{example}{Example}[section]

%\theoremstyle{plain}
\newtheorem{obs}{Observation}
\newtheorem{rem}{Remark}

% Reset numbering for each section
\numberwithin{equation}{section}
\section{Basics}


Let $\Omega \subset \mathbb{R}^d$ be an open, bounded, and simply connected domain. Then the filtration, or general porous medium equation is

\begin{equation}
\label{GPME}
	\partial_t u = \Delta \Phi(u) + f,
\end{equation}

 where $u, f: \Omega \times (0,\infty) \to \mathbb{R}$, and $\phi: \mathbb{R} \to \mathbb{R}$. For now we assume that $\Phi$ is continuous and nondecreasing.


\subsection{Problem statement}
I will consider on the following Dirichlet problem:
\begin{equation}
\label{HDP}
	\begin{cases}
		\partial_t u = \Delta \Phi(u) + f, \quad \text{ in } Q_T \\
		u(x,0) = u_0(x), \quad \text{ in } \Omega \\
		u(x,t) = 0, \quad \text{ on } \partial\Omega \times (0,T).
	\end{cases}
\end{equation}
Here $Q_T = \Omega \times (0,T)$, where $T$ may very well be infinite.
\subsection{Weak solutions}
\begin{mydef}[Weak solutions]
A locally integrable function $u$ defined in $Q_T$ is said to be a \textbf{weak solution} of (\ref{HDP}) if
\begin{enumerate}[i)]
	\item $u \in L^1(Q_T)$ and $\Phi(u) \in L^1(0,T : W_0^{1,1}(\Omega))$\footnote{$f:\Omega \to \mathbb{R}$ is an element of $W^{k,p}(\Omega)$ if all weak derivatives with $|\alpha| \leq k$ exists and are in $L^p(\Omega)$. $W_0^{k,p}$ is the closure of $C^\infty_c(\Omega)$ in $W^{k,p}(\Omega)$.};
	\item $u$ satisfies
		\begin{equation}
		\label{weak}
		\iint_{Q_T} \{\nabla\Phi(u)\cdot \nabla\eta - u\partial_t \eta \}dxdt = \int_\Omega u_0(x)\eta(x,0)dx + \iint_{Q_T}f\eta dxdt
		\end{equation}
for any $\eta \in C^1(\overline{Q}_T)$ that vanishes on $\partial \Omega \times [0,T)$ and for $t=T$.
\end{enumerate}
\end{mydef}

\begin{obs}
With $u_0 \in L^1(\Omega)$ and $f\in L^1(Q_T)$, all the integrals in (\ref{weak}) make sense.
\end{obs}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%		ENERGY SOLUTIONS:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Energy solutions}
We define  $\Psi$ as the primitive of $\Phi$ with $\Psi(0) = 0$, i.e.
\begin{equation*}
	\Psi(s) = \int_0^s \Phi(u) ds.
\end{equation*}
With this in mind we can define energy solutions in the following way:
\begin{mydef}[Energy solution]
We say that $u$ is a \textbf{weak energy solution} if it's a weak solution, and $u_0 \in L^1(\Omega)$ and $\Psi(u_0) \in L^1(\Omega)$, and the energy inequality
\begin{equation}
\label{energy_ineq}
\iint_{Q_T} |\nabla \Phi(u)|^2 dxdt + \int_\Omega \Psi(u(x,T))dx \leq \int_\Omega \Psi(u_0)dx + \iint_{Q_T}f\Phi(u)dxdt
\end{equation}
holds.
\end{mydef}

\subsubsection{Derivation of energy estimate for classical solutions}
Suppose $u$ is a smooth solution of (\ref{HDP}). We proceed by multiplying the equation with $\Phi(u)$ to get
\begin{equation*}
\Phi(u)\partial_t u = \Phi(u)\Delta \Phi(u) + \Phi(u)f,
\end{equation*}
and we notice that $\Phi(u)\partial_t u = \partial_t \Psi(u)$. That means when we integrate over $Q_T$ we have
\begin{equation*}
\iint_{Q_T} \partial_t \Psi(u)dxdt = \int_\Omega \Psi(u(T))dx - \int_\Omega \Psi(u_0)dx.
\end{equation*}
On the diffusive term we can use integration by parts, so
\begin{equation*}
\iint_{Q_T}\Phi(u) \Delta \Phi(u) dxdt = -\iint_{Q_T} |\nabla \Phi(u)|^2dxdt + \int_0^T \int_{\partial\Omega} \Phi(u)\nabla \Phi(u) \cdot \hat{n}dS,
\end{equation*}
where $\hat{n}$ is the outward unit normal. By the Dirichlet condition
\begin{equation*}
\iint_{Q_T}\Phi(u) \Delta \Phi(u) dxdt = -\iint_{Q_T} |\nabla \Phi(u)|^2dxdt,
\end{equation*}
and notice that this step would have been valid for homogeneous Neumann condition as well. In toto 
\begin{equation}
\iint_{Q_T} |\nabla \Phi(u)|^2dxdt + \int_\Omega \Psi(u(T))dx = \int_\Omega \Psi(u_0)dx + \iint_{Q_T} f\Phi(u)dxdt.
\end{equation}

\setcounter{obs}{0}
\begin{obs}
In contrast to (\ref{energy_ineq}) we have equality for smooth solutions.
\end{obs}

\begin{obs}
We can go even further and deal with the last term on the right hand side: Assuming $f,\Phi(u) \in L^2(Q_T)$, then
\begin{equation*}
\iint_{Q_T} f\Phi(u)dxdt \leq \left(\iint_{Q_T} f^2 dxdt\right)^\frac{1}{2}\left(\iint_{Q_T} \Phi(u)^2 dxdt\right)^\frac{1}{2},
\end{equation*}
by Cauchy-Schwarz'. With the inequality $\sqrt{ab} \leq \frac{1}{4c}a + cb$ for $c>0$
\begin{equation*}
\iint_{Q_T} f\Phi(u)dxdt \leq \frac{1}{4c}\iint_{Q_T}f^2dxdt + c\iint_{Q_T}\Phi(u)^2dxdt.
\end{equation*}
Lastly, because of the homogeneous Dirichlet conditions, we use the Poincaré inequality and set $c$ so that
\begin{equation*}
\iint_{Q_T} f\Phi(u)dxdt \leq C\iint_{Q_T}f^2dxdt + \frac{1}{2}\iint_{Q_T}|\nabla \Phi(u)|^2dxdt,
\end{equation*}
and the final inequality becomes
\begin{equation}
\frac{1}{2}\iint_{Q_T}|\nabla \Phi(u)|^2dxdt + \int_\Omega \Psi(u(T))dx \leq \int_\Omega \Psi(u_0)dx + C\iint_{Q_T}f^2dxdt.
\end{equation}
\end{obs}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%					ESTIMATES
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Some estimates}
Now we need to make some assumptions on $\Phi$ and $f$:
\begin{enumerate}[i)]
	\item The function $\Phi: \mathbb{R} \to \mathbb{R}$ is continuous, strictly increasing and we assume $\Phi(0) = 0$ without any loss of generality.
\end{enumerate}

For now the assumption that $\Phi'(u) > 0$ is kind of strong, but I hope to generalise (or find analogues for) most of the estimates to the case $\Phi'(u) \geq 0$. In that case (\ref{GPME}) changes from nodegenerate parabolic to degenerate parabolic. But hopes are high.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%					L^1-CONTRACTIVITY
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{$L^1$-contractivity}
Now we'll try to prove the following result:

\begin{proposition}
For two weak energy solutions $u$ and $\hat{u}$ with initial data $u_0$, $\hat{u}_0$ and forcing terms $f$, $\hat{f}$ respectively, we have for every $t > \tau \geq 0$
\begin{equation}
\label{l1_con}
||(u(t) - \hat{u}(t))_+||_1 \leq ||(u(\tau) - \hat{u}(\tau))_+||_1 + \int_\tau^t ||(f(s) - \hat{f}(s))_+||_1ds. 
\end{equation}
\end{proposition}

The proof will be done by establishing the result for smooth solutions of (\ref{HDP}). For such a solution to exist we must require that $\Phi'(u) > 0$, as well as some smoothness requirements on $f$ and $\partial\Omega \times (0,T)$ (I will check these smoothness assumptions). Then approximating the problem by smooth data, for which the $L^1$-contractivity holds, and pass to the limit.

\subsubsection{$L^1$-contractivity for smooth solutions}
Let $p: \mathbb{R} \to \mathbb{R}$ be a smooth function satisfying $p(s) = 0$ for $s \leq 0$, $p'(s) \geq 0$ for all $s\in \mathbb{R}$, and $0 \leq p(s) \leq 1$ for $s > 0$. Define now $w = \Phi(u) - \Phi(\hat{u})$, and multiply $p(w)$ with the difference of (\ref{GPME}) for $u$ and $\hat{u}$ to get
\begin{equation*}
\partial_t(u-\hat{u})p(w) = p(w)\Delta w + p(w)f.
\end{equation*}
Integrating over $\Omega$, and using integration by parts on the first part on the right hand side yields
\begin{align*}
\int_{\Omega}\partial_t(u-\hat{u})p(w)dx &= -\int_{\Omega}p'(w)|\nabla w|^2dx + \int_{\Omega}p(w)(f-\hat{f}) dx \\
	&\leq \int_{\Omega}p(w)(f-\hat{f}) dx \\
	&\leq \int_{\Omega}(f-\hat{f})_+ dx,
\end{align*}
where the last step follows from the fact that $0 \leq p(w) \leq 1$.
Now, let $p$ converge to the Heaviside function $H(w)$. Then, it is worth noticing that $H(w) = H(u-\hat{u})$, because of the strict monotonicity of $\Phi$. Also see that $\partial_t(u-\hat{u})_+ = \partial_t(u-\hat{u})H(u-\hat{u})$. Thus we get that
\begin{equation*}
\partial_t \int_{\Omega}(u-\hat{u})_+dx \leq \int_{\Omega}(f-\hat{f})_+ dx,
\end{equation*}
and integrating in time from $\tau$ to $t$ yields
\begin{equation*}
\int_{\Omega}(u(t)-\hat{u}(t))_+dx \leq \int_{\Omega}(u(\tau)-\hat{u}(\tau))_+dx + \int_\tau^t\int_{\Omega}(f-\hat{f})_+dxdt.
\end{equation*}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%					UNIQUENESS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Uniqueness}
\begin{theorem}[Uniqueness]
	Assuming in addition that $u \in L^2(Q_T)$ and $\Phi(u) \in L^2(0,T : H_0^1(\Omega))$, (\ref{HDP}) has at most one weak solution.
\end{theorem}
\begin{proof}
This is a pretty neat proof using a smart choice of $\eta$. So let's assume $u_1$ and $u_2$ are weak solutions. Then, when putting $u_1$ and $u_2$ into (\ref{weak}) and subtracting one from the other, we get
\begin{equation}
\label{weak_diff}
\iint_{Q_T}\nabla(\Phi(u_2) - \Phi(u_1)) \cdot \nabla \eta - (u_2 - u_1)\partial_t \eta dxdt = 0.
\end{equation}
Now the inspired move\footnote{Of course, this isn't my proof so that sort of horn-tooting is in good taste.} is choosing
\begin{equation*}
\eta(x,t) = \begin{cases}
		\int_t^T(\Phi(u_2) - \Phi(u_1))ds, \quad &\text{ if } 0 < t < T \\
		0 \quad &\text{ if } t\geq T.
	\end{cases}
\end{equation*}
We then have
\begin{equation*}
\begin{cases}
	\partial_t \eta &= -(\Phi(u_2) - \Phi(u_1) ) \\
	\nabla \eta &= \int_t^T\nabla (\Phi(u_2) - \Phi(u_1))ds,
\end{cases}
\end{equation*}
where the time derivation is valid using the First Fundamentel Theorem of Calculus and that $\Phi(u_i) \in L^1(0,T : W_0^{1,1}(\Omega))$ by the definition of weak soultion. For the validity of the spatial derivative, confer appendix \ref{sec:derivative}.

When putting these derivatives into the above equality we end up with
\begin{equation}
\label{unique}
\begin{aligned}
	&\iint_{Q_T}(\Phi(u_2) - \Phi(u_1))(u_2 - u_1)dxdt \\ 
	&+ \iint_{Q_T}\nabla(\Phi(u_2(t)) - \Phi(u_1(t))) \cdot \left(\int_t^T 					\nabla(\Phi(u_2(s)) - \Phi(u_1(s))ds\right)dtdx = 0.
\end{aligned}
\end{equation}
Let's take these in order:
\begin{enumerate}[i)]
	\item In the first integral we notice that $u_2 > u_1 \Rightarrow \Phi(u_2) \geq \Phi(u_1)$ and vice versa, so this integral is nonnegative.
	
	\item For the second integral it is helpful to first only consider integration of the temporal dimensions, leaving us with
	\begin{align*}
	&\int_0^T\int_t^T \nabla(\Phi(u_2(t)) - \Phi(u_1(t)))\cdot \nabla(\Phi(u_2(s))-\Phi(u_1(s)))dsdt \\
	&= \int_0^T\int_0^s\nabla(\Phi(u_2(t)) - \Phi(u_1(t)))\cdot \nabla(\Phi(u_2(s))-\Phi(u_1(s)))dtds.
	\end{align*}
	Due to the symmetry about the line $s=t$, we have
	\begin{align*}
	&\int_0^T\int_0^s\nabla(\Phi(u_2(t)) - \Phi(u_1(t)))\cdot \nabla(\Phi(u_2(s))-\Phi(u_1(s)))dtds \\
	&= \frac{1}{2}\int_0^T \int_0^T \nabla(\Phi(u_2(t)) - \Phi(u_1(t)))\cdot \nabla(\Phi(u_2(s))-\Phi(u_1(s)))dtds \\
	&= \frac{1}{2}\left( \int_0^T \nabla(\Phi(u_2)-\Phi(u_1))dt\right)^2,
	\end{align*}
	which is also nonnegative, and therefore the second integral in (\ref{unique}) must also be nonnegative.
\end{enumerate}
From this we may conclude that both integral terms in (\ref{unique}) are zero, which in turn implies, by the first integral that $(\Phi(u_2)-\Phi(u_1))(u_2 - u_1) = 0$ a.e. in $Q_T$. Actually, we have that $\Phi(u_2) - \Phi(u_1) = 0$ a.e., because wherever $u_2 = u_1$ it is trivially true, and wherever $ u_2 \neq u_1$ it holds from the first integral being zero. Thus, $ \nabla (\Phi(u_2) - \Phi(u_1) ) = 0$ a.e. and putting this into (\ref{weak_diff}) we get that
\begin{equation*}
\iint_{Q_T}(u_2 - u_1)\partial_t \eta dx dt = 0.
\end{equation*}
This should hold for any test function $\eta$, and so the weak derivative of $u_2 - u_1$ with respect to time is zero. Because $u_2$ and $u_1$ have identical initial condition $u_0$ we conclude that $u_2 = u_1$.
\end{proof}

\setcounter{obs}{0}
\begin{obs}
Provided $\iint_{Q_T} f\Phi(u)dxdt$ in (\ref{energy_ineq}) makes sense, $\Phi(u) \in L^2(0,T: H_0^1(\Omega))$ for weak energy solutions. If we can put on a condition on $u$ or any of the data to ensure that $u \in L^2(Q_T)$, we would have a condition under which weak energy solutions are unique. Hopefully, no such condition is required, but will perhaps follow from some other estimate.
\end{obs}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%				APPENDICES
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{appendices}
\section{Passing derivative inside the integral}
\label{sec:derivative}

We are now concern with whether
\begin{equation}
\label{diff_int}
	\nabla \int_t^T \varphi(x,s)ds = \int_t^T \nabla\varphi(x,s)ds
\end{equation}
holds or not for $\varphi \in L^2(0,T:H_0^1 (\Omega))$. 
For simplicity we now only consider one spatial dimension.

To begin with, assume that $\psi, \eta \in C^{\infty}_c$, then we have that
\begin{align*}
\int_{\Omega}\psi \partial_x\left(\int_t^T \eta(x,s) ds\right)dx &= \int_{\Omega}\psi \lim_{h \to 0}\left(\int_t^T \frac{\eta(x+h,s)-\eta(x,s)}{h} ds\right)dx\\
&= \int_{\Omega}\psi \lim_{h \to 0}\left(\int_t^T \eta_h(x,s) ds\right)dx.
\end{align*}

Assuming that $\partial_x \eta(x,s)$ is bounded, we can use the mean value theorem to state that $|\eta_h| \leq  ||\partial_x \eta||_\infty$. We also have that $\eta_h(x,s) \to \partial_x \eta(x,s)$ pointwise, and so we're in a position to use the Dominated Convergence theorem to conclude that
\begin{equation}
\label{results_diff_first}
\int_{\Omega}\psi \partial_x\left(\int_t^T \eta(x,s) ds\right)dx = \int_{\Omega}\psi \left(\int_t^T \partial_x\eta(x,s) ds\right)dx.
\end{equation}

To extend the result to $L^2(0,T:H_0^1 (\Omega))$ we use that $C_c^\infty$ is dense in this space. So let $\{\psi_n\},\{\varphi_n\}$ be two sequence converging to $\psi$ and $\varphi$ in $L^2(\Omega)$ and $L^2(0,T:H_0^1(\Omega))$ respectively. Considering the left hand side of (\ref{results_diff_first}), we get
\begin{align*}
&\left|\int_{\Omega}\psi \partial_x \left( \int_t^T\varphi ds \right)dx - \int_{\Omega}\psi_n \partial_x \left( \int_t^T \varphi_n ds \right) dx \right| \\
&\leq  \left| \int_{\Omega} \psi \partial_x \left(\int_t^T \varphi - \varphi_n ds\right)dx \right| + \left| \int_{\Omega}(\psi - \psi_n)\partial_x\left(\int_t^T \varphi_n ds\right) dx \right| \\
&\leq ||\psi||_{L^2(H_0^1)}|(\varphi -\varphi_n)|_{L^2(H_0^1)} + ||\psi-\psi_n||_{L^2}| \varphi_n |_{L^2(H_0^1)} \\
&\leq ||\psi||_{L^2(H_0^1)}||(\varphi -\varphi_n)||_{L^2(H_0^1)} + ||\psi-\psi_n||_{L^2}|| \varphi_n ||_{L^2(H_0^1)} \\
&\to 0,
\end{align*}
after using the triangle- and Cauchy-Schwarz' inequality as well as the assumptions on convergence.

An exactly similar approach can be done to the right hand side, and so passing the limit in (\ref{results_diff_first}) we get
\begin{equation}
\label{result_diff_final}
\int_\Omega \psi \partial_x\left(\int_t^T \varphi(x,s)ds\right)dx = \int_\Omega \psi \left( \int_t^T \partial_x \varphi(x,s)ds \right) dx.
\end{equation}

To get the more general (\ref{diff_int}), we simply apply this result for each individual spatial dimension while keeping the others fixed.
\end{appendices}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%				BIBLIOGRAPHY
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\bibliographystyle{plain}
\bibliography{project_bibliography.bib}
\end{document}



